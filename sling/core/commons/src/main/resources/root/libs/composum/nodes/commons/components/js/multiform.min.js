var $jscomp={scope:{}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(b,d,e){if(e.get||e.set)throw new TypeError("ES3 does not support getters and setters.");b!=Array.prototype&&b!=Object.prototype&&(b[d]=e.value)};$jscomp.getGlobal=function(b){return"undefined"!=typeof window&&window===b?b:"undefined"!=typeof global&&null!=global?global:b};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(b){return $jscomp.SYMBOL_PREFIX+(b||"")+$jscomp.symbolCounter_++};
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var b=$jscomp.global.Symbol.iterator;b||(b=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[b]&&$jscomp.defineProperty(Array.prototype,b,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(b){var d=0;return $jscomp.iteratorPrototype(function(){return d<b.length?{done:!1,value:b[d++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(b){$jscomp.initSymbolIterator();b={next:b};b[$jscomp.global.Symbol.iterator]=function(){return this};return b};$jscomp.array=$jscomp.array||{};$jscomp.iteratorFromArray=function(b,d){$jscomp.initSymbolIterator();b instanceof String&&(b+="");var e=0,a={next:function(){if(e<b.length){var c=e++;return{value:d(c,b[c]),done:!1}}a.next=function(){return{done:!0,value:void 0}};return a.next()}};a[Symbol.iterator]=function(){return a};return a};
$jscomp.polyfill=function(b,d,e,a){if(d){e=$jscomp.global;b=b.split(".");for(a=0;a<b.length-1;a++){var c=b[a];c in e||(e[c]={});e=e[c]}b=b[b.length-1];a=e[b];d=d(a);d!=a&&null!=d&&$jscomp.defineProperty(e,b,{configurable:!0,writable:!0,value:d})}};$jscomp.polyfill("Array.prototype.values",function(b){return b?b:function(){return $jscomp.iteratorFromArray(this,function(b,e){return e})}},"es6","es3");
$jscomp.findInternal=function(b,d,e){b instanceof String&&(b=String(b));for(var a=b.length,c=0;c<a;c++){var f=b[c];if(d.call(e,f,c,b))return{i:c,v:f}}return{i:-1,v:void 0}};$jscomp.polyfill("Array.prototype.find",function(b){return b?b:function(b,e){return $jscomp.findInternal(this,b,e).v}},"es6-impl","es3");
(function(b){b.components=b.components||{};(function(d,e){d.MultiFormItem=Backbone.View.extend({initialize:function(a){},getValue:function(){var a={};this.$(".widget").each(function(){if(this.view&&_.isFunction(this.view.getValue)){var c=b.getWidgetName(this.view);c&&(a[c]=this.view.getValue.apply(this.view))}});var c=_.values(a);1==c.length&&(a=c[0]);return a},setValue:function(a){this.$(".widget").each(function(){if(this.view&&_.isFunction(this.view.setValue)){var c=b.getWidgetName(this.view);this.view.setValue.apply(this.view,
[_.isObject(a)?a[c]:a])}})},reset:function(){var a=this.$(".widget");0<a.length?a.each(function(){this.view&&_.isFunction(this.view.reset)&&this.view.reset.apply(this.view)}):this.$("input").val(void 0)},clone:function(){var a=this.$el.clone();a.find(".richtext-widget").each(function(){d.richTextWidget.afterClone.apply(this,[$(this)])});return a}});d.MultiFormWidget=Backbone.View.extend({initialize:function(a){this.itemList=[];this.itemType=a.itemType||d.MultiFormItem;this.name=this.$el.attr("data-name")||
"name";a=this.$(".multi-form-item");for(var c=0;c<a.length;c++)this.itemList[c]=this.newItem(a[c]);this.current(this.itemList[0]);0==this.$(".action-bar").length&&this.$el.append('<div class="action-bar btn-toolbar" role="toolbar"><div class="btn-group btn-group-sm"><button type="button" class="add glyphicon-plus glyphicon btn btn-default" title="Add Filter"><span class="label">Add</span></button><button type="button" class="remove glyphicon-minus glyphicon btn btn-default" title="Remove Filter"><span class="label">Remove</span></button></div><div class="btn-group btn-group-sm"><button type="button" class="move-up glyphicon-chevron-up glyphicon btn btn-default" title="Move Up"><span class="label">Up</span></button><button type="button" class="move-down glyphicon-chevron-down glyphicon btn btn-default" title="Move Down"><span class="label">Down</span></button></div></div>');
this.$(".action-bar button.add").unbind("click").on("click",_.bind(this.add,this));this.$(".action-bar button.remove").unbind("click").on("click",_.bind(this.remove,this));this.$(".action-bar button.move-up").unbind("click").on("click",_.bind(this.moveUp,this));this.$(".action-bar button.move-down").unbind("click").on("click",_.bind(this.moveDown,this))},getValue:function(){for(var a=[],c=0;c<this.itemList.length;c++){var d=this.itemList[c].getValue();(c<this.itemList.length-1||!b.isEmptyObject(d))&&
a.push(d)}return a},setValue:function(a){if(a){this.reset(a.length);for(var c=0;c<this.itemList.length;c++)this.itemList[c].setValue(a[c])}else this.reset(0)},reset:function(a){if(!a||1>a)a=1;for(;this.itemList.length>a;)this.remove();for(var c=0;c<this.itemList.length;c++)this.itemList[c].reset();for(;this.itemList.length<a;)this.add()},newItem:function(a){return b.getView(a,this.itemType,_.bind(function(a){0==a.$(".item-select").length&&a.$el.prepend('<input class="item-select form-control" type="radio" name="item-select-'+
this.name+'">');a.$(".item-select").unbind("click").on("click",_.bind(this.onSelect,this));window.widgets.setUp(a.el)},this),this.itemType!=d.MultiFormItem)},onSelect:function(a){a=$(a.currentTarget).closest(".multi-form-item")[0];for(var c=0;c<this.itemList.length;c++)if(a===this.itemList[c].el){this.itemList[c].$(".item-select").unbind("click");this.current(this.itemList[c]);this.itemList[c].$(".item-select").on("click",_.bind(this.onSelect,this));break}},indexOf:function(a){return _.indexOf(this.itemList,
a)},current:function(a){if(a&&0<=this.indexOf(a)){this.currentItem=a;for(a=0;a<this.itemList.length;a++)this.itemList[a].$el.removeClass("current"),this.itemList[a].$(".item-select").attr("value",a);this.currentItem.$el.addClass("current");this.currentItem.$(".item-select").click()}return this.currentItem},add:function(){var a=this.currentItem,c=this.itemList[this.itemList.length-1],b=_.isFunction(c.clone)?c.clone():c.$el.clone();c.$el.parent().append(b);c=this.newItem(b);c.reset();this.itemList[this.itemList.length]=
c;this.current(a)},remove:function(){if(1<this.itemList.length){var a=this.indexOf(this.currentItem);a==this.itemList.length-1&&a--;this.currentItem.$el.remove();this.itemList=_.without(this.itemList,this.currentItem);this.current(this.itemList[a])}else this.itemList[0].reset()},moveUp:function(){var a=this.indexOf(this.currentItem);if(0<a){var b=1<a?_.first(this.itemList,a-1):[],d=a<this.itemList.length-1?_.rest(this.itemList,a+1):[];this.itemList=_.union(b,[this.currentItem],[this.itemList[a-1]],
d);this.currentItem.$el.insertBefore(this.currentItem.$el.prev())}},moveDown:function(){var a=this.indexOf(this.currentItem);if(a<this.itemList.length-1){var b=0<a?_.first(this.itemList,a):[],d=a<this.itemList.length-2?_.rest(this.itemList,a+2):[];this.itemList=_.union(b,[this.itemList[a+1]],[this.currentItem],d);this.currentItem.$el.insertAfter(this.currentItem.$el.next())}},getWidgetValue:function(a){var c=b.widgetOf(a,this);return c&&_.isFunction(c.getValue)?c.getValue():a.val()},setWidgetValue:function(a,
c){var d=b.widgetOf(a,this);d&&_.isFunction(d.setValue)?d.setValue(c):a.val(c)}});e.register(".widget.multi-form-widget",d.MultiFormWidget)})(b.components,window.widgets)})(window.core);
