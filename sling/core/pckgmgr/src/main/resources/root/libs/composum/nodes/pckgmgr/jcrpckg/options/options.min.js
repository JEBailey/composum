(function(a){a.pckgmgr=a.pckgmgr||{};(function(c){c.EditOptionsDialog=a.components.Dialog.extend({initialize:function(b){a.components.Dialog.prototype.initialize.apply(this,[b]);this.form=a.getWidget(this.el,"form.widget-form",a.components.FormWidget);this.$("button.save").click(_.bind(this.submitForm,this))},initDialog:function(b){this.form.$el.attr("action",a.getContextUrl("/bin/cpm/package.update.json"+c.getCurrentPath()));this.form.setValues(b)},submitForm:function(b){b.preventDefault();this.submitFormPut()}});
c.getEditOptionsDialog=function(){return a.getView("#pckg-options-change-dialog",c.EditOptionsDialog)};c.EditRelationsDialog=a.components.Dialog.extend({initialize:function(b){a.components.Dialog.prototype.initialize.apply(this,[b]);this.form=a.getWidget(this.el,"form.widget-form",a.components.FormWidget);this.relations=a.getWidget(this.el,".relations.widget",a.components.MultiFormWidget);this.$("button.save").click(_.bind(this.submitForm,this))},initDialog:function(b,d,e){this.form.$el.attr("action",
a.getContextUrl("/bin/cpm/package.update.json"+c.getCurrentPath()));this.$(".modal-title").text(d);this.relations.$el.data("name",b);this.form.setValues(e)},submitForm:function(b){b.preventDefault();this.submitFormPut()}});c.getEditRelationsDialog=function(){return a.getView("#pckg-relations-change-dialog",c.EditRelationsDialog)};c.OptionsTab=a.console.DetailTab.extend({initialize:function(b){this.$detail=this.$(".options-detail");this.$(".detail-toolbar .advanced").click(_.bind(this.editOptions,
this));this.$(".detail-toolbar .dependencies").click(_.bind(this.editDependencies,this));this.$(".detail-toolbar .replaces").click(_.bind(this.editReplaces,this));this.$(".detail-toolbar .refresh").click(_.bind(this.refresh,this))},editOptions:function(b){b.preventDefault();var a=c.getEditOptionsDialog();a.show(_.bind(function(){a.initDialog({acHandling:this.$(".ac-handling [data-value]").attr("data-value"),requiresRoot:this.$(".requires-root [data-value]").attr("data-value"),requiresRestart:this.$(".requires-restart [data-value]").attr("data-value"),
providerName:this.$(".provider-name .value-text").text(),providerUrl:this.$(".provider-url .value-text").text(),providerLink:this.$(".provider-link .value-text").text()})},this),_.bind(this.refresh,this))},editDependencies:function(a){a.preventDefault();var b=c.getEditRelationsDialog();b.show(_.bind(function(){b.initDialog("dependencies","Change Dependencies",{dependencies:this.relationsSet("dependencies")})},this),_.bind(this.refresh,this))},editReplaces:function(a){a.preventDefault();var b=c.getEditRelationsDialog();
b.show(_.bind(function(){b.initDialog("replaces","Change Replaces List",{replaces:this.relationsSet("replaces")})},this),_.bind(this.refresh,this))},relationsSet:function(a){var b=[];this.$("."+a+" .relation").each(function(){b.push($(this).text())});return b},refresh:function(b){b&&b.preventDefault();a.ajaxGet(a.getContextUrl("/bin/packages.options.html"+c.getCurrentPath()),{},_.bind(function(a){this.$detail.html(a)},this))}})})(a.pckgmgr)})(window.core);
